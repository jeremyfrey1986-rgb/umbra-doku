<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Umbra Doku - Sanctuaire de Lecture</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,300;0,700;1,300&family=Inter:wght@300;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .font-serif { font-family: 'Crimson Pro', serif; }
        .bg-papyrus { background-image: url("https://www.transparenttextures.com/patterns/papyrus.png"); }
        .bg-obsidian { background: radial-gradient(circle, #1A1A1E 0%, #0D0D0F 100%); }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        .animate-float { animation: float 6s infinite ease-in-out; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // D√©finition du Logo Umbra (Panda sur le dos)
        const UmbraLogo = ({ className = "w-12 h-12" }) => (
            <svg viewBox="0 0 100 100" className={className} fill="none">
                <circle cx="50" cy="50" r="48" stroke="currentColor" strokeWidth="0.5" strokeDasharray="2 2" opacity="0.2" />
                <g transform="translate(0, 5)">
                    <ellipse cx="50" cy="65" rx="25" ry="18" fill="currentColor" fillOpacity="0.05" stroke="currentColor" strokeWidth="1" />
                    <circle cx="50" cy="38" r="14" fill="currentColor" fillOpacity="0.05" stroke="currentColor" strokeWidth="1" />
                    <circle cx="38" cy="28" r="5" fill="currentColor" />
                    <circle cx="62" cy="28" r="5" fill="currentColor" />
                    {/* Le Grimoire tenu par les pattes */}
                    <path d="M40 48 H60 L65 65 H35 L40 48Z" fill="#580000" stroke="currentColor" strokeWidth="1" />
                    {/* Pattes */}
                    <circle cx="35" cy="55" r="4" fill="currentColor" />
                    <circle cx="65" cy="55" r="4" fill="currentColor" />
                </g>
            </svg>
        );

        const GothicLace = ({ color = "#580000", position = "bottom" }) => (
            <div className={`w-full h-8 overflow-hidden pointer-events-none absolute left-0 ${position === 'top' ? '-top-4' : '-bottom-4'}`}
                 style={{
                    backgroundImage: `url("data:image/svg+xml,%3Csvg width='100' height='40' viewBox='0 0 100 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 20 Q25 0 50 20 T100 20 V40 H0 Z' fill='none' stroke='${encodeURIComponent(color)}' stroke-width='0.5' opacity='0.4'/%3E%3C/svg%3E")`,
                    backgroundRepeat: 'repeat-x',
                    backgroundSize: '80px 30px',
                    transform: position === "top" ? 'rotate(180deg)' : 'none'
                 }}
            />
        );

        const App = () => {
            const [isDarkMode, setIsDarkMode] = useState(true);
            const [books, setBooks] = useState([]);
            const [view, setView] = useState('library');
            const [currentBook, setCurrentBook] = useState(null);

            const handleFileUpload = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const newBook = {
                    id: Date.now(),
                    title: file.name.replace(/\.[^/.]+$/, ""),
                    url: URL.createObjectURL(file)
                };
                setBooks([...books, newBook]);
            };

            const theme = isDarkMode ? {
                bg: 'bg-[#0D0D0F]', text: 'text-[#C4C4C4]', accent: 'text-[#8B0000]', 
                card: 'bg-[#16161A]', border: 'border-[#301b3f]', lace: '#580000'
            } : {
                bg: 'bg-[#E8E2D2] bg-papyrus', text: 'text-[#2C2C2E]', accent: 'text-[#580000]',
                card: 'bg-[#F2EFE6]', border: 'border-[#A38D6D]', lace: '#A38D6D'
            };

            return (
                <div className={`min-h-screen ${theme.bg} ${theme.text} font-serif transition-all duration-700`}>
                    {view === 'library' ? (
                        <>
                            <header className={`${theme.card} border-b ${theme.border} relative px-8 py-10 shadow-2xl`}>
                                <div className="max-w-6xl mx-auto flex flex-col md:flex-row items-center justify-between gap-6">
                                    <div className="flex items-center gap-6">
                                        <UmbraLogo className={`w-16 h-16 ${theme.accent}`} />
                                        <div>
                                            <h1 className={`text-4xl font-light tracking-[0.2em] uppercase ${theme.accent}`}>Umbra Doku</h1>
                                            <p className="text-[10px] tracking-[0.4em] uppercase opacity-40 font-sans">Archives de Saky</p>
                                        </div>
                                    </div>
                                    <div className="flex items-center gap-6">
                                        <button onClick={() => setIsDarkMode(!isDarkMode)} className="p-2 opacity-50 hover:opacity-100">
                                            {isDarkMode ? 'üåô' : '‚òÄÔ∏è'}
                                        </button>
                                        <label className={`cursor-pointer border-2 ${theme.border} ${theme.accent} px-8 py-2 text-xs uppercase tracking-widest font-bold hover:bg-[#580000] hover:text-white transition-all`}>
                                            Invoquer PDF
                                            <input type="file" accept=".pdf" className="hidden" onChange={handleFileUpload} />
                                        </label>
                                    </div>
                                </div>
                                <GothicLace color={theme.lace} position="bottom" />
                            </header>

                            <main className="max-w-6xl mx-auto px-8 py-20">
                                {books.length === 0 ? (
                                    <div className="text-center py-40 opacity-20">
                                        <p className="text-sm uppercase tracking-[0.5em] italic">Le sanctuaire attend vos grimoires...</p>
                                    </div>
                                ) : (
                                    <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-10">
                                        {books.map(book => (
                                            <div key={book.id} onClick={() => { setCurrentBook(book); setView('reader'); }} 
                                                 className="group cursor-pointer">
                                                <div className={`aspect-[3/4.5] ${theme.card} border-2 ${theme.border} relative shadow-xl transition-all duration-500 group-hover:-translate-y-2 flex flex-col items-center justify-center p-4`}>
                                                    <div className="absolute top-0 left-0 w-4 h-4 border-t border-l border-current opacity-20"></div>
                                                    <div className="absolute bottom-0 right-0 w-4 h-4 border-b border-r border-current opacity-20"></div>
                                                    <h3 className="text-[10px] uppercase tracking-wider text-center line-clamp-4 px-2">{book.title}</h3>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </main>
                        </>
                    ) : (
                        <div className="fixed inset-0 bg-black flex flex-col">
                            <nav className="p-4 flex items-center justify-between border-b border-white/5 bg-black">
                                <button onClick={() => setView('library')} className="text-[11px] uppercase tracking-widest opacity-50 hover:opacity-100">‚Üê Retour</button>
                                <span className="text-[11px] uppercase tracking-widest truncate max-w-xs">{currentBook?.title}</span>
                                <div className="w-10"></div>
                            </nav>
                            <object data={currentBook?.url} type="application/pdf" className="flex-1 w-full h-full">
                                <div className="p-20 text-center text-white/20 uppercase text-[10px] tracking-[0.4em]">Aper√ßu indisponible - Veuillez t√©l√©charger le grimoire</div>
                            </object>
                        </div>
                    )}
                    <footer className="py-20 text-center opacity-20 text-[9px] uppercase tracking-[0.8em]">
                        Umbra Doku &bull; MMXXVI
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
